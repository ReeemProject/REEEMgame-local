extends _layout
//worldID pin nickname roles clientScenario
block content
   script.
     $("body").css('background', '#D1F3F9');
   script(src="https://www.gstatic.com/charts/loader.js")
   //script(src='/express-public' + version +'/twoAreasData.js')
   //script(src='/express-public' + version +'/AllstateDataMin.js')
   script(src='/express-public' + version +'/AllEUstateData.js')
   div(id='pWorld')
     div(id='pMenu').menu 
       h2(style='text-align: center') WorldID: #{worldID} 
       div(id='dd2').dropdown
         button.btn.dropdown-toggle(type='button' data-toggle='dropdown') #{nickname}
         ul.dropdown-menu
           li
             button(id='openWelcomeMsg').dropdownButton Open Welcome Message
       div.menuItems
         div#accordionContainer.scrollbar.style-1
           if currentRole == 'Facilitator'
             div(id='timeControl')
               p
                span.menuHeading Time Controls
               div.accordionContent
           
           div(id='role')
             
               p
                span.menuHeading Role
               div.accordionContent
                 ul
                   li 
                     button(id='roleButton' title='Your role (either East, West or Observer)').menuButton #{currentRole.m_name}
           if currentRole == 'Facilitator'
             div(id='participants')
             p
              span.menuHeading Participants

           div(id='data')
             p
              span.menuHeading Available Indicators
             div#dataContent.accordionContent
               ul
                 each role in roles              
                   if role.m_name == currentRole.m_name
                     each indicator in role.m_indicators
                       li 
                         button(id='#{indicator.m_id}' title='#{indicator.m_description}').menuButton !{indicator.m_name}: #{indicator.m_value} #{indicator.m_unit}
                    
         
             
           div(id='decision' title='You have two decisions to make in each month: the level of heating subsidies to the population in your country, and the level of investments in renewable facilities in your country. Adjust the levers below accordingly.')
               p
                span.menuHeading Decisions
               div.accordionContent
                 ul(id='decisionList').progressUL
                   each role in roles              
                     if role.m_name == currentRole.m_name
                       each decision in role.m_decisions                     
                         li
                           table
                            tbody
                              tr
                               td
                                 span #{decision.m_name}:
                               td
                                 div(id='#{decision.m_id}'+'value')
                           div.progressBar(id='#{decision.m_id}' title='#{decision.m_description}')
                 
           div(id='otherDecisionsContainer')
             p
              span.menuHeading All Participant's Decisions
             div.accordionContent
               ul.progressUL
                 each role in roles  
                   if (role.m_decisions.length)
                     p #{role.m_name}
                   each decision in role.m_decisions
                     li
                        table
                            tbody
                              tr
                               td
                                 span #{decision.m_name}:
                               td
                                 div(id='#{decision.m_id}'+'barValue')
                        div.progress.progressBar.otherDecProgress
                          div.progress-bar(id='#{decision.m_id}'+'bar' title='#{decision.m_description}' role="progessbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%; transition:none;" )

           div(id='score' class='menuHeading' title='The combined score calculated as the average of the social, economic and environmental scores. East and West have a joint responsibility to maximize this value in 2050.')
              p
                span#scoreHeading.menuHeading Score
              div.accordionContent
                 ul
                   li 
                     button(id='socialScore' title='The average social score for East and West. Based on the (housing temperature) comfort level.').menuButton Social: 50
                   li 
                     button(id='economicScore' title='The average economic score for East and West. Based on the GDP/person.').menuButton Economic: 50
                   li 
                     button(id='environmentalScore' title='The average environmental score for East and West. Based on the CO2 emissions.').menuButton Environmental: 50
           div#historyAcc
             p
               span.menuHeading History
             div.accordionContent
              ul#history
               li
                 button#currentSimBtn.menuButton(hidden='true') Current Simulation
      div(id='date').menu
      table(id='dateTable')
        tbody
          tr
            td
              #month.date June
            td
              #year.date 2017
        div#simulationNumber.menu.date 
     div(id='pMap') 
     
       
     div#timeBarContainer 
       div#progressBar.progress.dateProgress
         div.progress-bar.dateProgressValue( role="progessbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%; transition:none;")
       div#progressBarSlider.progress.dateProgress(style="display:none")
         div#custom-handle.ui-slider-handle.leftHandle
         div#custom-handle-locked.ui-slider-handle.rigthHandle
   script(src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.js')
  
   script(src='/express-public' + version + '/dist/connectBundle.js')
   script(src='/express-public' + version + '/dist/partBundle.js')
   
   script.
    $( function() {
      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      var connection = new connectBundle.Connection('#{worldID}', "/game11"); 
      var r = !{JSON.stringify( roles )}
      var cr = '#{currentRole}';
      console.log("CurrentRole: " + cr);
      var participant = new partBundle.Participant(connection, !{JSON.stringify(currentRole)}, {name: '#{nickname}', currentRole: '#{currentRole.m_name}', permissions: !{JSON.stringify(permissions)}}, #{newParticipant});
      });

      
  
      
     
